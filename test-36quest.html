<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>36í€˜ìŠ¤íŠ¸ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: #1a1a2e;
            color: white;
            padding: 20px;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            background: #2a2a3e;
            border: 2px solid #ff69b4;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        h2 {
            color: #ff69b4;
        }
        button {
            background: #ff69b4;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #ff1493;
        }
        .result {
            background: #1a1a2e;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success {
            color: #4caf50;
        }
        .error {
            color: #f44336;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ® 36í€˜ìŠ¤íŠ¸ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="test-section">
            <h2>1. í€˜ìŠ¤íŠ¸ ë°ì´í„° ë¡œë“œ í…ŒìŠ¤íŠ¸</h2>
            <button onclick="testLoadQuestData()">í€˜ìŠ¤íŠ¸ ë°ì´í„° ë¡œë“œ</button>
            <div id="quest-load-result" class="result"></div>
        </div>
        
        <div class="test-section">
            <h2>2. ìºë¦­í„° ë°ì´í„° í…ŒìŠ¤íŠ¸</h2>
            <button onclick="testCharacterData()">ìºë¦­í„° ë°ì´í„° í™•ì¸</button>
            <div id="character-result" class="result"></div>
        </div>
        
        <div class="test-section">
            <h2>3. API ì—°ê²° í…ŒìŠ¤íŠ¸</h2>
            <button onclick="testQuestAPI()">í€˜ìŠ¤íŠ¸ API í…ŒìŠ¤íŠ¸</button>
            <button onclick="testScenarioAPI()">ì‹œë‚˜ë¦¬ì˜¤ API í…ŒìŠ¤íŠ¸</button>
            <div id="api-result" class="result"></div>
        </div>
        
        <div class="test-section">
            <h2>4. í€˜ìŠ¤íŠ¸ ì„ íƒ UI í…ŒìŠ¤íŠ¸</h2>
            <button onclick="testQuestUI()">í€˜ìŠ¤íŠ¸ ì„ íƒ ëª¨ë‹¬ ì—´ê¸°</button>
            <div id="ui-result" class="result"></div>
        </div>
        
        <div class="test-section">
            <h2>5. ì§„í–‰ë„ ì €ì¥/ë¡œë“œ í…ŒìŠ¤íŠ¸</h2>
            <button onclick="testSaveProgress()">ì§„í–‰ë„ ì €ì¥</button>
            <button onclick="testLoadProgress()">ì§„í–‰ë„ ë¡œë“œ</button>
            <div id="progress-result" class="result"></div>
        </div>
    </div>

    <script>
        // í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ë“¤
        async function testLoadQuestData() {
            const resultDiv = document.getElementById('quest-load-result');
            try {
                // ë¡œì»¬ JSON íŒŒì¼ ë¡œë“œ ì‹œë„
                const response = await fetch('/data/quests/quest-database.json');
                const data = await response.json();
                
                resultDiv.innerHTML = `<span class="success">âœ… í€˜ìŠ¤íŠ¸ ë°ì´í„° ë¡œë“œ ì„±ê³µ!</span>\n`;
                resultDiv.innerHTML += `ì´ í€˜ìŠ¤íŠ¸: ${data.metadata.total_quests}ê°œ\n`;
                resultDiv.innerHTML += `ì¹´í…Œê³ ë¦¬: ${Object.keys(data.categories).length}ê°œ\n`;
                resultDiv.innerHTML += `- ${Object.values(data.categories).map(c => c.name).join('\n- ')}`;
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">âŒ ë¡œë“œ ì‹¤íŒ¨: ${error.message}</span>`;
            }
        }
        
        async function testCharacterData() {
            const resultDiv = document.getElementById('character-result');
            try {
                const response = await fetch('/data/characters-extended/mbti-characters.json');
                const data = await response.json();
                
                resultDiv.innerHTML = `<span class="success">âœ… ìºë¦­í„° ë°ì´í„° ë¡œë“œ ì„±ê³µ!</span>\n`;
                resultDiv.innerHTML += `ì´ ìºë¦­í„°: ${Object.keys(data.characters).length}ëª…\n\n`;
                
                Object.values(data.characters).forEach(char => {
                    resultDiv.innerHTML += `${char.name} (${char.mbti}) - ${char.status}\n`;
                });
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">âŒ ë¡œë“œ ì‹¤íŒ¨: ${error.message}</span>`;
            }
        }
        
        async function testQuestAPI() {
            const resultDiv = document.getElementById('api-result');
            try {
                const response = await fetch('/api/quest-manager?action=list');
                const data = await response.json();
                
                if (data.success) {
                    resultDiv.innerHTML = `<span class="success">âœ… í€˜ìŠ¤íŠ¸ API ì—°ê²° ì„±ê³µ!</span>\n`;
                    resultDiv.innerHTML += JSON.stringify(data.metadata, null, 2);
                } else {
                    throw new Error('API ì‘ë‹µ ì‹¤íŒ¨');
                }
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">âŒ API ì—°ê²° ì‹¤íŒ¨: ${error.message}</span>`;
            }
        }
        
        async function testScenarioAPI() {
            const resultDiv = document.getElementById('api-result');
            try {
                const response = await fetch('/api/scenario?action=test');
                const data = await response.json();
                
                resultDiv.innerHTML = `<span class="success">âœ… ì‹œë‚˜ë¦¬ì˜¤ API ì—°ê²° ì„±ê³µ!</span>\n`;
                resultDiv.innerHTML += JSON.stringify(data, null, 2);
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">âŒ API ì—°ê²° ì‹¤íŒ¨: ${error.message}</span>`;
            }
        }
        
        function testQuestUI() {
            const resultDiv = document.getElementById('ui-result');
            try {
                // ê°„ë‹¨í•œ ëª¨ë‹¬ í…ŒìŠ¤íŠ¸
                const modal = document.createElement('div');
                modal.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#2a2a3e;padding:20px;border:2px solid #ff69b4;border-radius:10px;z-index:1000;';
                modal.innerHTML = `
                    <h3 style="color:#ff69b4;">í€˜ìŠ¤íŠ¸ UI í…ŒìŠ¤íŠ¸</h3>
                    <p>ëª¨ë‹¬ì´ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤!</p>
                    <button onclick="this.parentElement.remove()">ë‹«ê¸°</button>
                `;
                document.body.appendChild(modal);
                
                resultDiv.innerHTML = `<span class="success">âœ… UI í…ŒìŠ¤íŠ¸ ëª¨ë‹¬ ìƒì„±ë¨</span>`;
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">âŒ UI í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}</span>`;
            }
        }
        
        function testSaveProgress() {
            const resultDiv = document.getElementById('progress-result');
            try {
                const testData = {
                    unlockedQuests: ['quest_001', 'quest_002'],
                    completedQuests: ['quest_001'],
                    userProgress: {
                        totalAffection: 50,
                        questsCompleted: 1,
                        currentStreak: 1
                    },
                    lastSaved: new Date().toISOString()
                };
                
                localStorage.setItem('questProgress_test', JSON.stringify(testData));
                resultDiv.innerHTML = `<span class="success">âœ… ì§„í–‰ë„ ì €ì¥ ì„±ê³µ!</span>\n`;
                resultDiv.innerHTML += JSON.stringify(testData, null, 2);
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">âŒ ì €ì¥ ì‹¤íŒ¨: ${error.message}</span>`;
            }
        }
        
        function testLoadProgress() {
            const resultDiv = document.getElementById('progress-result');
            try {
                const saved = localStorage.getItem('questProgress_test');
                if (saved) {
                    const data = JSON.parse(saved);
                    resultDiv.innerHTML = `<span class="success">âœ… ì§„í–‰ë„ ë¡œë“œ ì„±ê³µ!</span>\n`;
                    resultDiv.innerHTML += JSON.stringify(data, null, 2);
                } else {
                    resultDiv.innerHTML = `<span class="error">ì €ì¥ëœ ì§„í–‰ë„ê°€ ì—†ìŠµë‹ˆë‹¤.</span>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">âŒ ë¡œë“œ ì‹¤íŒ¨: ${error.message}</span>`;
            }
        }
    </script>
</body>
</html>