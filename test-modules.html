<!DOCTYPE html>
<html>
<head>
    <title>ğŸ§ª ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ v2.2</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>ğŸ§ª ëª¨ë“ˆ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ v2.2</h1>
    <div id="results"></div>
    
    <script type="module">
        import gameArch from './modules/core/architecture.js';
        import DataSchema from './modules/core/schema.js';
        import choiceLogic from './modules/game/choice-logic.js';
        import freeChat from './modules/game/free-chat.js';
        import episodeFlow from './modules/game/episode-flow.js';
        
        async function runTests() {
            const results = document.getElementById('results');
            
            try {
                // 1. ì•„í‚¤í…ì²˜ í…ŒìŠ¤íŠ¸
                const initResult = await gameArch.initialize();
                results.innerHTML += `<div class="test-section success">âœ… ì•„í‚¤í…ì²˜ ì´ˆê¸°í™”: ${initResult}</div>`;
                
                // 2. ìŠ¤í‚¤ë§ˆ í…ŒìŠ¤íŠ¸
                const testData = DataSchema.createDefault('gameState');
                results.innerHTML += `<div class="test-section success">âœ… ê¸°ë³¸ ê²Œì„ìƒíƒœ ìƒì„± ì™„ë£Œ</div>`;
                
                // 3. ì„ íƒì§€ ë¡œì§ í…ŒìŠ¤íŠ¸
                const choiceResult = await choiceLogic.processChoice(
                    { choiceIndex: 0, choiceText: 'í…ŒìŠ¤íŠ¸ ì„ íƒ', affectionImpact: 2 },
                    testData
                );
                results.innerHTML += `<div class="test-section success">âœ… ì„ íƒì§€ ì²˜ë¦¬: ${choiceResult.success}</div>`;
                
                // 4. ììœ  ì±„íŒ… í…ŒìŠ¤íŠ¸
                freeChat.toggleFreeChatMode(true);
                results.innerHTML += `<div class="test-section success">âœ… ììœ  ì±„íŒ… ëª¨ë“œ í™œì„±í™”</div>`;
                
                // 5. ì—í”¼ì†Œë“œ í”Œë¡œìš° í…ŒìŠ¤íŠ¸
                const progress = episodeFlow.getCurrentProgress();
                results.innerHTML += `<div class="test-section success">âœ… ì—í”¼ì†Œë“œ ì§„í–‰ë¥ : ${progress.progressPercent}%</div>`;
                
                console.log('ğŸ‰ ëª¨ë“  ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ ì™„ë£Œ');
                results.innerHTML += `<div class="test-section success"><h3>ğŸ‰ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼!</h3></div>`;
                
            } catch (error) {
                console.error('âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error);
                results.innerHTML += `<div class="test-section error">âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}</div>`;
            }
        }
        
        runTests();
    </script>
</body>
</html>