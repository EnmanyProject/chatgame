<!DOCTYPE html>
<html>
<head>
    <title>🧪 모듈 테스트 v2.2</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>🧪 모듈 시스템 테스트 v2.2</h1>
    <div id="results"></div>
    
    <script type="module">
        import gameArch from './modules/core/architecture.js';
        import DataSchema from './modules/core/schema.js';
        import choiceLogic from './modules/game/choice-logic.js';
        import freeChat from './modules/game/free-chat.js';
        import episodeFlow from './modules/game/episode-flow.js';
        
        async function runTests() {
            const results = document.getElementById('results');
            
            try {
                // 1. 아키텍처 테스트
                const initResult = await gameArch.initialize();
                results.innerHTML += `<div class="test-section success">✅ 아키텍처 초기화: ${initResult}</div>`;
                
                // 2. 스키마 테스트
                const testData = DataSchema.createDefault('gameState');
                results.innerHTML += `<div class="test-section success">✅ 기본 게임상태 생성 완료</div>`;
                
                // 3. 선택지 로직 테스트
                const choiceResult = await choiceLogic.processChoice(
                    { choiceIndex: 0, choiceText: '테스트 선택', affectionImpact: 2 },
                    testData
                );
                results.innerHTML += `<div class="test-section success">✅ 선택지 처리: ${choiceResult.success}</div>`;
                
                // 4. 자유 채팅 테스트
                freeChat.toggleFreeChatMode(true);
                results.innerHTML += `<div class="test-section success">✅ 자유 채팅 모드 활성화</div>`;
                
                // 5. 에피소드 플로우 테스트
                const progress = episodeFlow.getCurrentProgress();
                results.innerHTML += `<div class="test-section success">✅ 에피소드 진행률: ${progress.progressPercent}%</div>`;
                
                console.log('🎉 모든 모듈 테스트 완료');
                results.innerHTML += `<div class="test-section success"><h3>🎉 모든 테스트 통과!</h3></div>`;
                
            } catch (error) {
                console.error('❌ 테스트 실패:', error);
                results.innerHTML += `<div class="test-section error">❌ 테스트 실패: ${error.message}</div>`;
            }
        }
        
        runTests();
    </script>
</body>
</html>