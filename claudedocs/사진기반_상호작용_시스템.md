# 📸 사진 기반 상호작용 시스템 개발 기획

> 메신저 형태의 채팅 게임에서 캐릭터가 호감도에 따라 사진을 전송하고 상호작용하는 시스템

## 🎯 핵심 컨셉

### 시스템 개요
- **메신저 형태**: 실제 카카오톡/텔레그램과 같은 대화방 UI
- **사진 전송**: 캐릭터가 호감도에 따라 단계적으로 사진 공유
- **상호작용**: "나 예뻐요?", "이 부위 어때요?" 등 질문과 평가 요청
- **진행성**: 호감도 증가 → 더 개방적/친밀한 사진 → 깊은 상호작용

### 게임플레이 예시
```
[호감도 25 달성]
캐릭터: "오늘 카페에서 찍었어! 나 어때? ☕️😊" [사진 전송]
선택지: [예뻐요] [귀여워요] [좋아해요] [더 보고싶어요]

[호감도 65 달성]
캐릭터: "이 드레스 어때? 너한테만 보여주고싶었어.. 💕" [사진 전송]
선택지: [완벽해요] [아름다워요] [설레요] [더 가까이서 보고싶어요]
```

## 📋 개발 항목별 상세 기획

### 1️⃣ 사진 전송 시스템 설계 및 구현

#### 호감도별 사진 카테고리 매핑
```javascript
const PHOTO_UNLOCK_SYSTEM = {
  0-20: ['profile'],           // 기본 프로필
  21-40: ['casual'],           // 일상 사진
  41-60: ['emotional'],        // 감정 표현
  61-80: ['romantic'],         // 로맨틱한 사진
  81-100: ['special']          // 특별한/친밀한 사진
};
```

#### 사진 전송 이벤트 구조
```javascript
class PhotoSendEvent {
  constructor(photoId, message, expectation, affectionRequired) {
    this.photoId = photoId;
    this.message = message;           // "나 어때? 😊"
    this.expectation = expectation;   // 'compliment', 'reaction', 'question'
    this.affectionRequired = affectionRequired;
  }
}
```

### 2️⃣ 호감도별 사진 해금 로직 구현

```javascript
// 사진 해금 시스템
function unlockPhotos(currentAffection, characterId) {
  const character = getCharacter(characterId);
  const availablePhotos = character.photos.filter(photo =>
    photo.unlockAffection <= currentAffection && !photo.sent
  );

  // 확률적 사진 전송 (호감도가 높을수록 더 자주)
  const sendProbability = Math.min(currentAffection / 100 * 0.3, 0.8);

  if (Math.random() < sendProbability && availablePhotos.length > 0) {
    return selectRandomPhoto(availablePhotos);
  }
  return null;
}
```

### 3️⃣ 사진 기반 대화 시나리오 시스템 개발

#### 사진별 대화 템플릿
```javascript
const PHOTO_DIALOGUE_TEMPLATES = {
  'casual': [
    {
      message: "오늘 카페에서 찍었어! 나 어때? ☕️😊",
      responses: ['예뻐요', '귀여워요', '좋아해요', '더 보고싶어요'],
      followUp: {
        positive: "고마워~ 기분 좋아졌어! ❤️",
        neutral: "그렇구나.. 더 예쁘게 찍을게!",
        negative: "앗.. 아직 어색하구나 😅"
      }
    }
  ],
  'romantic': [
    {
      message: "이 드레스 어때? 너한테 보여주고싶었어.. 💕",
      responses: ['완벽해요', '아름다워요', '설레요', '더 가까이서 보고싶어요'],
      followUp: {
        positive: "진짜? 너만을 위해 입었는데... 😘",
        flirty: "가까이서 보고싶다고? 언젠가... 😉"
      }
    }
  ]
};
```

### 4️⃣ 메신저 UI에 사진 표시 기능 추가

#### 사진 메시지 컴포넌트
```javascript
function createPhotoMessage(photoData, messageText, timestamp) {
  return `
    <div class="message character-message photo-message">
      <div class="message-header">
        <img src="${character.profileImage}" class="profile-img">
        <span class="character-name">${character.name}</span>
        <span class="timestamp">${timestamp}</span>
      </div>
      <div class="photo-container">
        <img src="${photoData.base64}" class="sent-photo" onclick="openPhotoModal('${photoData.id}')">
        <div class="photo-overlay">
          <span class="photo-category">${photoData.category}</span>
        </div>
      </div>
      <div class="message-text">${messageText}</div>
      <div class="photo-reactions">
        ${generateReactionButtons(photoData.expectedReactions)}
      </div>
    </div>
  `;
}
```

### 5️⃣ 사진별 반응 평가 시스템 구현

#### 반응 평가 엔진
```javascript
class PhotoReactionEvaluator {
  evaluateResponse(photo, userResponse, character) {
    const evaluation = {
      affectionChange: 0,
      characterResponse: '',
      unlockBonus: false
    };

    // MBTI별 반응 선호도
    const mbtiPreferences = {
      'ENFP': { preferred: ['enthusiastic', 'creative'], bonus: 2 },
      'INFP': { preferred: ['gentle', 'emotional'], bonus: 3 },
      'ESFJ': { preferred: ['warm', 'caring'], bonus: 2 }
    };

    // 사진 카테고리별 가중치
    const categoryWeight = {
      'casual': 1.0,
      'romantic': 1.5,
      'special': 2.0
    };

    // 평가 로직
    if (this.isPositiveResponse(userResponse, photo.expectedTone)) {
      evaluation.affectionChange = mbtiPreferences[character.mbti].bonus * categoryWeight[photo.category];
      evaluation.characterResponse = this.generatePositiveResponse(character, photo);
    }

    return evaluation;
  }
}
```

## 🔧 기술적 구현 요소

### 데이터 구조 확장
```json
{
  "photos": {
    "photoId": {
      "category": "romantic",
      "unlockAffection": 60,
      "sent": false,
      "sentTimestamp": null,
      "userReactions": [],
      "contextMessage": "이 드레스 어때? 너한테 보여주고싶었어..",
      "expectedReactions": ["compliment", "desire", "appreciation"],
      "followUpScenarios": {
        "positive": "고마워~ 너 때문에 더 예뻐진 것 같아 ❤️",
        "flirty": "그렇게 보면... 부끄러워 😘"
      }
    }
  }
}
```

### 호감도 연동 시스템
```javascript
// 게임 진행 중 사진 전송 트리거
function checkPhotoSendTrigger(affectionIncrease, totalAffection) {
  const newlyUnlockedPhotos = getNewlyUnlockedPhotos(totalAffection - affectionIncrease, totalAffection);

  if (newlyUnlockedPhotos.length > 0 && shouldSendPhoto(affectionIncrease)) {
    const photoToSend = selectPhotoBasedOnContext(newlyUnlockedPhotos, currentConversationTone);
    return schedulePhotoSend(photoToSend, calculateDelay());
  }
}
```

## 📱 UI/UX 고려사항

1. **사진 크기 최적화**: 메신저에서 적절한 크기로 표시
2. **로딩 애니메이션**: 사진 전송 시 타이핑 효과
3. **반응 버튼**: 빠른 응답을 위한 원터치 버튼
4. **사진 확대**: 클릭 시 전체화면 모달
5. **히스토리 관리**: 보낸 사진들의 갤러리 기능

## 🎮 게임플레이 플로우

1. **일반 대화** → 호감도 상승
2. **특정 호감도 도달** → 사진 전송 이벤트 발생
3. **사진과 메시지 수신** → 사용자 반응 선택
4. **반응 평가** → 추가 호감도 변화 및 후속 대화
5. **새로운 사진 카테고리 해금** → 더 친밀한 단계로 진행

## 📝 개발 진행 상황

### ✅ 완료된 작업
- [ ] 기본 기획 문서 작성
- [ ] 호감도별 사진 해금 시스템 설계
- [ ] 반응 평가 시스템 설계

### 🔄 진행 중인 작업
- [ ] 사진 전송 시스템 구현
- [ ] 메신저 UI 확장
- [ ] 대화 시나리오 시스템 개발

### 📋 예정된 작업
- [ ] 사진별 반응 평가 시스템 구현
- [ ] 호감도 연동 테스트
- [ ] UI/UX 최적화

---

## 💡 추가 아이디어 및 개선사항

*새로운 아이디어나 개선사항이 있을 때마다 이 섹션에 추가됩니다.*

### 아이디어 로그
- **[2025-10-01]** 초기 기획 완료 - 호감도 기반 사진 전송 시스템 설계

---

*마지막 업데이트: 2025-10-01*
*작성자: Claude Code + 사용자*